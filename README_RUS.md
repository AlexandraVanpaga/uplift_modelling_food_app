### Uplift Modeling для Яндекс Еда

**Цель проекта**
построение модели аплифт-моделирования для выявления пользователей, наиболее вероятно откликающихся на маркетинговое воздействие.
Данные содержат признаки пользовательской активности, каналов коммуникации и поведения, а также информацию о том, получал ли пользователь treatment (например, предложение или кампанию).


**Выбор модели**

Для решения задачи была выбрана X-Learner по следующим причинам:

- наличие гетерогенности в данных (различие откликов между подгруппами)

- дисбаланс классов между контрольной и тестовой группами

В качестве базовых моделей внутри X-Learner использовался RandomForestClassifier, показавший наилучшие результаты среди протестированных алгоритмов.

**Генерация признаков**

На основе анализа корреляций и важности признаков были сгенерированы дополнительные фичи, отражающие взаимодействия между наиболее информативными переменными.
В итоговый набор вошли признаки:

['zip_code',
 'newbie',
 'channel',
 'womens_x_recency_high',
 'premium_inactive',
 'newbie_womens_high_recency',
 'recency',
 'history_segment',
 'womens',
 'mens',
 'recency history_segment',
 'recency womens',
 'recency mens',
 'history_segment womens',
 'history_segment mens',
 'womens mens']

**Подбор гиперпараметров**

Подбор гиперпараметров осуществлялся с помощью библиотеки Optuna.
Целевая метрика для оптимизации - максимизация plift@30%.

**Результаты**
Метрики лучшей модели X-Learner (RandomForest)

- Uplift AUC: 0.0223
- Qini AUC:	0.0513
- Uplift@30%:	0.0461


**Интерпретация результатов**

Метрики невысокие, что отражает реально небольшой uplift в исходных данных.

При этом статистически значимая разница между тестовой и контрольной группами подтверждает наличие эффекта.

Значение Uplift@30% = 0.0461 означает, что среди топ-30% пользователей по предсказанному uplift фактический отклик на 4.6% выше, чем у контрольной группы.

Модель в 12 раз лучше случайного предсказания, что свидетельствует о способности выделять пользователей с повышенным откликом.

Для отдельных сегментов (например, с низким уровнем трат) uplift может быть отрицательным. Это нормальное поведение для аплифт-моделей, так как они концентрируются на пользователях, действительно реагирующих на treatment.

**Выводы**

- X-Learner с RandomForest показал стабильные результаты на задаче с гетерогенными и несбалансированными данными.

- Генерация синтетических фичей на основе взаимодействий улучшила предсказательную способность.

- Полученная модель применима для приоритизации клиентов в маркетинговых кампаниях, повышая эффективность коммуникаций.
